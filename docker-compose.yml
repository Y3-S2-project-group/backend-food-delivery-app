version: '3.8'

services:
  # Auth Service
  auth-service:
    build: ./auth-service
    container_name: auth-service
    ports:
      - "8000:8000"
    environment:
      - PORT=${PORT}
      - MONGO_URI=${MONGO_URI}
      - JWT_SECRET=${JWT_SECRET}
      - EMAIL_USER=${EMAIL_USER}
      - EMAIL_PASS=${EMAIL_PASS}
    networks:
      - app-network
  
 # Restaurant Service
  restaurant-service:
    build: ./restaurant-service
    container_name: restaurant-service
    ports:
      - "5000:5000"
    environment:
      - PORT=5000
      - MONGO_URI=${RESTAURANT_MONGO_URI}
      - JWT_SECRET=${JWT_SECRET}
    networks:
      - app-network
      
# Delivery Service
  delivery-service:
    build: ./delivery-service
    container_name: delivery-service
    ports:
      - "5002:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ServiceUrls__AuthService=http://auth-service:8000
      - ServiceUrls__RestaurantService=http://restaurant-service:5000
      - ServiceUrls__OrderService=http://order-service:5001
      - DatabaseSettings__ConnectionString=${DELIVERY_MONGO_URI}
    networks:
    - app-network

networks:
  app-network:
    driver: bridge